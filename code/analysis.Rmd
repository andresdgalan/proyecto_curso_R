---
title: "proyecto"
author: "Lidia y Andr√©s"
date: "21/09/2022"
output: html
---
#packages for modelling and visualization
```{r}
library(MuMIn)
library(DHARMa)
library(ggplot2)
library(mgcv) 
library(tidymv) 
library(visreg) 
library(mgcViz) 
library(dplyr)
library(here)
library(readr)

```

Subir datos de DIVERSIFICA:

```{r read_data, include=FALSE}

DIVERSIFICA.plot <- read_delim(here("data/st.DIVERSIFICA.plot.csv"), delim = ";")
DIVERSIFICA.plot <- DIVERSIFICA.plot[-27, ]
DIVERSIFICA.plot$DBH2 <- DIVERSIFICA.plot$DBH^2

DIVERSIFICA.tree <- read_delim(here("data/st.DIVERSIFICA.tree.strange.csv"), delim = ";")
```

```{r Linear Model, echo=FALSE}

plotModel<- lm (def ~ DBH + DBH2 + mycrhz + NO3 + comp, data = DIVERSIFICA.plot, na.action = na.fail)

#to compare all possible models with AIC
res <- dredge(plotModel, trace=0)

```

Keep only the best models and visualize them:

```{r subset, echo = TRUE}
subset(res, delta <= 2)

```

See the error of the estimate and the significance of the effect

```{r summary, echo = TRUE}

summary(model.avg(res, subset = delta < 2, revised.var=FALSE))

```

See the importance of each variable:

```{r importance, echo = TRUE}

sw(subset(model.sel(res), delta <= 2))

```

Paquete DHARMA

```{r dharma, echo = TRUE}

simulateResiduals(plotModel, plot = TRUE)

```

Plot model visreg

```{r plotting, echo = TRUE}
visreg(plotModel)
```

